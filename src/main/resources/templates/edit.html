<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <!-- TODO -->
    <title>POST</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>

<body>
    <!-- title -->
    <div class="container-post-title">
        <h1 class="post-title" th:text="${post.getTitle()}"></h1>
        <button onclick="edit(this)" class="edit-btn"><img th:src="@{/icon/edit.svg}" alt="edit"></button>
    </div>

    <div class="container-info">
        <!-- date -->
        <p th:text="${post.getDate()}">data: </p>

        <!-- views -->
        <p th:text="${post.getViews()} + ' views'">views: </p>
    </div>
    <hr class="post">
    <div class="container-content">
        <!-- content -->
        <p th:utext="${#strings.replace(post.getContent(), '&#13;', '<br/>')}"></p>
        <button onclick="edit(this)" class="edit-btn"><img th:src="@{/icon/edit.svg}" alt="edit"></button>
    </div>
    <hr class="post">

    <div class="container-comment">
        <!-- comments -->
        <h2>Comments</h2>
        <ul>
            <li class="comment-block" th:each="comment : ${post.getComments()}" th:if="${comment != null}">

                <p class="autore" th:text="${comment.getAuthor()}"></p>
                <span>-</span>
                <p class="data" th:text="${comment.getDate()}"></p>

                <p class="contenuto" th:text="${comment.getContent()}"></p>
            </li>
        </ul>

        <!-- if there isn-t any comment -->
        <p th:if="${post.getComments().size() == 0}">No comments yet</p>

        <!-- new comment form -->
        <p>Tell us your opinion!</p>
        <form th:attr="action='/post/' + ${post.getId()} + '/add-comment'" method="POST">
            <label for="content">Commento</label> <br>
            <textarea id="content" name="content"></textarea>
            <br>
            <label for="author">Autore</label> <br>
            <input type="text" id="author" name="author">
            <br>
            <button type="submit">Comment</button>
        </form>

    </div>
    <script>
        function edit(element) {
            element_before = element.previousElementSibling;
            element_before.setAttribute("contenteditable", "true");
            element_before.focus();

            // change the button
            element.setAttribute("onclick", "save(this)");
            element.innerHTML = "<img src='/icon/save.svg' alt='save'>";

        }
    </script>
</body>
</html>